# 적은 오버랩에서 사용 가능한 3차원 점군 정합 방법

A Modified Method for Registration of 3D Point Clouds with a Low Overlap Ratio

http://journal.cg-korea.org/archive/view_article?pid=jkcgs-24-5-11



본 논문에서는 노이즈를 포함한채 오버랩 영역이 적은 두 점군을 정합할 때 정확도와 수렴 속도를 향상시키는 알고리즘을 제시한다. 정확도를 높이기 위하여 점군의 기하학 정보를 최대한 활용하며, 정합단계에서는 노이즈가 포함된 점군에서 오버랩되는 영역을 적절히 선택하고, 개선된 가속 알고리즘을 사용하여 정합 속도를 향상시킨다. 정확도를 향상시키는 기존의 방법은 노이즈가 많은 점군에 적용할 수 없으므로, 본 논문에서는 정합에 사용되는 영역을 선택하는 것으로써 기존 방법의 문제를 해결하였다. 또한 똑같은 점군쌍에서만 적용되는 가속 알고리즘을 낮은 오버랩의 점군쌍에 적용하였다. 기존의 방법에 간단한 알고리즘을 추가함으로써 서너 배 더 빠른 수렴 속도를 낼 수 있도록 하였다. 결론적으로, 노이즈가 많고 오버랩이 적은 점군쌍의 정합에 있어서 본 논문에서 제시하는 알고리즘을 적용하면 속도와 정확도가 향상되었음을 알 수 있다.


## 1. 서론 

- 점군 정합에서는 알고리즘을 간단하게 만들어 속도를 높이고 오버랩 영역을 정밀하게 찾아 정확도를 높이는 것이 중요하다.

- 본 논문에서는 ICP(Iterative Closest Point) 알고리즘을 사용하 였다. 
    - ICP 알고리즘은 초기 정합이 완료된 상태, 즉 점군들이 대략적으로 정렬된 상태에서 강체(rigid) 정합을 하는 데 있어서 가장 강력한 방법이다[1]. 

- 제안 방법 : ICP에 기하학 기반의 샘플링 방법을 이용하여 정합의 정확도를 향상시키는 알고리즘을 제시하였다. 그리고 정합 속도를 빠르게 하기 위해 가속화 알고리즘을 추가함으로써 정합 속도를 향상시켰다[2].

---

## 2. 관련 연구 

### 2.1 정합 


#### A. 정의 

3차원 공간상의 물체에 대하여 카메라로 어느 한 방향에서 점군 (point cloud) 데이터를 얻는다면, 획득한 데이터는 자체적으로 지역 좌표계 (local coordinate system)를 가진다. 하지만 하나의 데이터만을 획득하는 것으로는 물체에 대한 모든 정보를 알 수 없다. 그래서 그 물체에 대해 각기 다른 여러 방향에서 데이터를 얻는 다. 그리고 이 데이터들을 원래 물체처럼 하나로 나타내기 위해 하나의 전역 좌표계(global coordinate system)로 표현한다. 이렇둣, 여러 점군 데이터의 여러 지역 좌표계를 점군 데이터 세트 하나의 전역 좌표계로 표현하는 과정을 정합이라고 한다[1].

#### B. 분류 

정합은 점군 데이터의 개수에 따라, 
- 데이터가 둘이면 이중 정합(pairwise registration), 
- 셋 이상이면 다중 정합(multiview registration)으로 구분할 수 있다. 

#### C. 기존 연구 

- Besl은 알고리즘의 우수성을 입증하기 위한 수단으로 점 (point set)과 곡선 (curve)과 면 (surface) 에 대하여 각각 이중 정합을 수행하였다[3]. 

- 또, Lee는 멀티 센서를 정합에 충분히 활용할수 있음을 보이기 위해 센서들을 부착한 스캐너로 빌딩 외부를 실제로 스캔하였고 이렇게 획득한 점군들로 이중 정합을 완료하였다[4]. 

- 반면, Pulli는 미켈란젤로의 다비드 조각상을 스캔하고 다중 정합을 진행하기에 앞서 이중 정합을 먼저하고 난 뒤 이를 다중 정합의 제약(constraint)으로 적용하였다[5]. 

- 최근에는 Yun은 선체의 블록을 조립하는 조선 현장에서 스캔한 15개의 점군들로 다중 정합을 수행하였다[6]. 

- 본 논문에서는 다중 정합을 고려하지 않은 채 이중 정합만을 다룬다.


### 2.2 ICP 알고리즘

m_a개의 점을 포함하는 소스 점군(source point cloud) A를 mb개의 점을 포함하는 타갯 점군(target point cloud) B에 정합한다고 가정하자. 이 때 ICP 알고리즘은 그림 2처럼 여섯 단계로 이루어져\ 있으며, 각 단계는 다음과 같이 요약할 수 있다.

![](http://journal.cg-korea.org/journal/jkcgs/jkcgs-24-5/gif/jkcgs-24-5-11-g2.gif)


첫째, 점 선택(point selection) 단계에서는 알고리즘의 계산량을 줄이기 위하여 노이즈 필터링이나 샘플링을 거쳐 점의 갯수를 줄인다. 둘째, 이웃 선택(neighborhood selection) 단계에서는 각 점의 주변에 분포하는 점들 중 가까운 점 일부를 선택한다. 셋째, 점쌍 매칭(point pair matching) 단계에서는 앞서 선택한 주변 점들로 곡면(surface)[6]이나 평면(plane)[7] 같은 기하학 요소를 만들고, 이를 이용하여 소스 점군 A의 점 에 대응하는(corresponding) 타갯 점군 표의 점을 찾는다. 넷째, 오정합점 제거 (outlier rejection) 단계에서는 소스 점군 A와 타겟 점군 B에서 서로 겹치는 부분, 즉 오버랩 영역(inlier)만 남기고, 겹치지 않는 영역(outlier) 은 정합에 이용하지 않는다. 다섯째, 오차 최소화(error minimization) 단계 에서는 소스 점군 A의 오버랩 영역 A′과 타겟 점군 B의 오버랩 영역 B′ 방향으로 이동하는 동안 각 대응점의 거리 오차가 최소가 되도록 한다. 여섯째, 변환(Transformation) 단계에서 는 소스 오버랩 점군 A′가 타갯 오버랩 점군 B′의 위치로 이동하 는 데에 필요한병진 행렬(translation matrix)과 회전 행렬(rotation matrix)을 구하여 소스 오버랩 점군 A′에 적용한다. 여기서 거리 오차가 일정한 한계치(tolerance, τ) 이하이면 진행을 멈주고 한계치 이상이라면 점쌍 매칭 (point pair matching) 단계로 되돌아가서 알고리즘을 다시 수행한다.

이러한 ICP 알고리즘은 병진 3자유도와 회전 3자유도를 다루기 때문에 공간상의 모든 방향으로 적용할 수 있는 것은 물론, 점군 데이터의 국소 특징(local feature)이나 전처리(prepocessing)가 필요 없기 때문에 알고리즘이 비교적 간단하다는 장점을 가지고 있다[3]. 하지만 점쌍 매칭 단계에서 대응점 (corresponding point)을 찾는 과정이 알고리즘 1회 수행하는 데에 최대 O(mamb)의 복잡도를 보이는데다가, 오버랩 영역이 매우 적거나 없어 분할된 상태의 점군에 적용하면 정합이 잘못되는 경우가 허다하다[3]. 또, 성게처럼 형상이 복잡하거나[3] 사무용 건물 같이 반복되는 패턴의 경우에도 알고리즘을 적용하기 어렵다.

Besl은 회전 행렬을 구하는 데에 Horn의 최소 자승 사원수 연산(least square quaternion operation)[8]을 이용하여 변환 단계에 적용하였다[3]. 반면, Masuda는 오정합점 제거 단계에서 잔차의 표준 편차(standard deviation of residuals)를 도입하여 이 값의 2.5 배를 거리 임계값(distance threshold)로 설정하였다. 이 때 임계값 이하이면 정합점 (inlier)으로, 초과하면 오정합점 (outlier)으로 구 분하였다[9]. 여기서 Masuda는 샘플링이 일정하지 않은 무작위 샘플링(random sampling)을 사용한 반면, 본 논문에서는 균일 샘플링 (uniform sampling)을 사용하였다. 한편, Pulli는 점쌍 매칭 단계에서 정적 임계값(hard threshold) 내에서 대응점을 찾되, 각 점 군의 법선 벡터(compatible normal vector)의 사잇각이 45도 이하 이고, 대응점이 메시 경계(mesh boundary) 위에 있지 않는다면 오버랩 영역에 해당하는 동적 임계값(dynamic threshold)을 유지한 채 매칭 대칭(matching symmetric)을 만드는 경험적인(heuristic) 방법을 제안하였다[5]. 그러나 임계값들을 조절하며 많은 시행착오를 거쳐야 하기 때문에 원하는 정합을 얻기까지 오랜 시간이 걸린다는 단점을 안고 있다.

---


## 3. 제안 방법

## 4. 성능 평가 

## 5. 결론 

ICP 알고리즘은 점 개수가 많은 점군 데이터의 정합에 효과적이다. 

다만 ICP 알고리즘이 점들의 위치를 변화시키지 않기 때문에 연식(non-rigid) 정합에는 적합하지 않을지라도, 플랜트나 조선 등 다루는 구조물이 크고 복잡한 산업 현장에는 매우 효과적임은 단언할 수 있다. 

이러한 상황에서는 스캔한 점군의 점 개수가 매우 많기 때문에 샘플링과 가속화가 필수적이다. 

하지만 본 논문의 샘플링 알고리즘에는 평면을 제거하는 단계가 있기 때문에 평면을 가진 구조물에는 적용할 수 없다는 단점을 안고 있다. 

이 단점을 극복하기 위해서는 평면을 포함하면서도 불필요한 점쌍을 정확히 찾는 알고리즘을 추가해야 한다. 

그리고 본 논문의 가속 알고리즘이 간단하고 강력할지라도 정확도가 다소 떨어진다는 단점이 있다. 

그래서 정확도 감소를 최소화하도록 본 논문의 알고리즘을 더 발전시켜야 한다.



